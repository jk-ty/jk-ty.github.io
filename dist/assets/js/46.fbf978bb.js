(window.webpackJsonp=window.webpackJsonp||[]).push([[46],{1592:function(t,a,s){"use strict";s.r(a);var e=s(6),n=Object(e.a)({},(function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"_4、约束"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4、约束"}},[t._v("#")]),t._v(" 4、约束")]),t._v(" "),e("h2",{attrs:{id:"_1、概述"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1、概述"}},[t._v("#")]),t._v(" 1、概述")]),t._v(" "),e("p",[t._v("概念：约束是作用于表中字段上的规则，用于限制存储在表中的数据。\n目的：保证数据库中数据的正确、有效性和完整性。\n分类:")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",[t._v("约束")]),t._v(" "),e("th",[t._v("描述")]),t._v(" "),e("th",[t._v("关键字")])])]),t._v(" "),e("tbody",[e("tr",[e("td",[t._v("非空约束")]),t._v(" "),e("td",[t._v("限制该字段的数据不能为null")]),t._v(" "),e("td",[t._v("NOT NULL")])]),t._v(" "),e("tr",[e("td",[t._v("唯一约束")]),t._v(" "),e("td",[t._v("保证该字段的所有数据都是唯一、不重复的")]),t._v(" "),e("td",[t._v("UNIQUE")])]),t._v(" "),e("tr",[e("td",[t._v("主键约束")]),t._v(" "),e("td",[t._v("主键是一行数据的唯一标识，要求非空且唯一")]),t._v(" "),e("td",[t._v("PRIMARY   KEY")])]),t._v(" "),e("tr",[e("td",[t._v("默认约束")]),t._v(" "),e("td",[t._v("保存数据时，如果未指定该字段的值，则采用默认值")]),t._v(" "),e("td",[t._v("DEFAULT")])]),t._v(" "),e("tr",[e("td",[t._v("检查约束(8.0.16版本之后)")]),t._v(" "),e("td",[t._v("保证字段值满足某一个条件")]),t._v(" "),e("td",[t._v("CHECK")])]),t._v(" "),e("tr",[e("td",[t._v("外键约束")]),t._v(" "),e("td",[t._v("用来让两张表的数据之间建立连接，保证数据的一致性和完整性")]),t._v(" "),e("td",[t._v("FOREIGN   KEY")])])])]),t._v(" "),e("p",[t._v("注意：约束是作用于表中字段上的，可以在创建表/修改表的时候添加约束。")]),t._v(" "),e("h2",{attrs:{id:"_2、演示"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2、演示"}},[t._v("#")]),t._v(" 2、演示")]),t._v(" "),e("p",[t._v("​\t根据需求，完成表结构的创建。需求如下：")]),t._v(" "),e("p",[e("img",{attrs:{src:s(962),alt:"1"}})]),t._v(" "),e("p",[t._v("对应的建表语句为：")]),t._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("CREATE TABLE tb_user(\nid int AUTO_INCREMENT PRIMARY KEY COMMENT 'ID唯一标识',\nname varchar(10) NOT NULL UNIQUE COMMENT '姓名' ,\nage int check (age > 0 && age <= 120) COMMENT '年龄' ,\nstatus char(1) default '1' COMMENT '状态',\ngender char(1) COMMENT '性别'\n);\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br")])]),e("p",[e("img",{attrs:{src:s(963),alt:"1"}})]),t._v(" "),e("h2",{attrs:{id:"_3、外键约束"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3、外键约束"}},[t._v("#")]),t._v(" 3、外键约束")]),t._v(" "),e("h3",{attrs:{id:"_1、介绍"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1、介绍"}},[t._v("#")]),t._v(" 1、介绍")]),t._v(" "),e("p",[e("strong",[t._v("外键：用来让两张表的数据之间建立连接，从而保证数据的一致性和完整性。")])]),t._v(" "),e("h3",{attrs:{id:"_2、语法"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2、语法"}},[t._v("#")]),t._v(" 2、语法")]),t._v(" "),e("h4",{attrs:{id:"_1-添加外键"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-添加外键"}},[t._v("#")]),t._v(" 1). 添加外键")]),t._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("CREATE TABLE 表名(\n字段名 数据类型,\n...\n[CONSTRAINT] [外键名称] FOREIGN KEY (外键字段名) REFERENCES 主表 (主表列名)\n);\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br")])]),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("ALTER TABLE 表名 ADD CONSTRAINT 外键名称 FOREIGN KEY (外键字段名)\nREFERENCES 主表 (主表列名) ;\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br")])]),e("p",[t._v("案例:\n为emp表的dept_id字段添加外键约束,关联dept表的主键id。")]),t._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("alter table emp add constraint fk_emp_dept_id foreign key (dept_id) references\ndept(id);\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br")])]),e("p",[t._v("添加了外键约束之后，我们再到dept表(父表)删除id为1的记录，然后看一下会发生什么现象。 此时\n将会报错，不能删除或更新父表记录，因为存在外键约束。")]),t._v(" "),e("h4",{attrs:{id:"_2-删除外键"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-删除外键"}},[t._v("#")]),t._v(" 2). 删除外键")]),t._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("ALTER TABLE 表名 DROP FOREIGN KEY 外键名称;\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br")])]),e("p",[t._v("案例：\n删除emp表的外键fk_emp_dept_id。")]),t._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("alter table emp drop foreign key fk_emp_dept_id;\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br")])]),e("h3",{attrs:{id:"_3、删除-更新行为"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3、删除-更新行为"}},[t._v("#")]),t._v(" 3、删除/更新行为")]),t._v(" "),e("p",[t._v("添加了外键之后，再删除父表数据时产生的约束行为，我们就称为删除/更新行为。具体的删除/更新行\n为有以下几种:")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",[t._v("行为")]),t._v(" "),e("th",[t._v("说明")])])]),t._v(" "),e("tbody",[e("tr",[e("td",[t._v("NOACTION")]),t._v(" "),e("td",[t._v("当在父表中删除/更新对应记录时，首先检查该记录是否有对应外键，如果有则不允许删除/更新。 (与 RESTRICT 一致) 默认行为")])]),t._v(" "),e("tr",[e("td",[t._v("RESTRICT")]),t._v(" "),e("td",[t._v("当在父表中删除/更新对应记录时，首先检查该记录是否有对应外键，如果有则不允许删除/更新。 (与 NO ACTION 一致) 默认行为")])]),t._v(" "),e("tr",[e("td",[t._v("CASCADE")]),t._v(" "),e("td",[t._v("当在父表中删除/更新对应记录时，首先检查该记录是否有对应外键，如果有，则也删除/更新外键在子表中的记录。")])]),t._v(" "),e("tr",[e("td",[t._v("SET NULL")]),t._v(" "),e("td",[t._v("当在父表中删除对应记录时，首先检查该记录是否有对应外键，如果有则设置子表中该外键值为null（这就要求该外键允许取null）。")])]),t._v(" "),e("tr",[e("td",[t._v("SETDEFAULT")]),t._v(" "),e("td",[t._v("父表有变更时，子表将外键列设置成一个默认的值 (Innodb不支持)")])])])]),t._v(" "),e("p",[t._v("具体语法为:")]),t._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("ALTER TABLE 表名 ADD CONSTRAINT 外键名称 FOREIGN KEY (外键字段) REFERENCES\n主表名 (主表字段名) ON UPDATE CASCADE ON DELETE CASCADE;\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br")])]),e("p",[t._v("演示:")]),t._v(" "),e("p",[t._v("1). CASCADE")]),t._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("alter table emp add constraint fk_emp_dept_id foreign key (dept_id) references\ndept(id) on update cascade on delete cascade ;\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br")])]),e("p",[t._v("2). SET NULL")]),t._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("alter table emp add constraint fk_emp_dept_id foreign key (dept_id) references\ndept(id) on update set null on delete set null;\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br")])])])}),[],!1,null,null,null);a.default=n.exports},962:function(t,a,s){t.exports=s.p+"assets/img/1.f207c23f.jpg"},963:function(t,a,s){t.exports=s.p+"assets/img/2.9c5733f9.png"}}]);